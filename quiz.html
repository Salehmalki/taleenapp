<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ุงุฎุชุจุงุฑ ูุณุจ ุงููุจู ๏ทบ</title>
  <link rel="stylesheet" href="assets/css/enhanced-style.css">
  <link rel="stylesheet" href="assets/css/compatibility.css">
  <link rel="stylesheet" href="assets/css/safari-fix.css">
  <link rel="stylesheet" href="assets/css/improved-fonts.css">
  <link rel="stylesheet" href="assets/css/countdown-timer.css">
  <link rel="stylesheet" href="assets/css/mobile-navigation.css">
  <script src="assets/js/improved-audio.js" defer></script>
  <script src="assets/js/ios-compatibility.js" defer></script>
</head>
<body>
  <header>
    <h1>ุงุฎุชุจุฑ ูุนูููุงุชู ูู ูุณุจ ุงููุจู ๏ทบ</h1>
  </header>

  <main class="quiz-container">
    <div id="quizBox">
      <div id="question" class="question-box"></div>
      <div id="answers" class="answers-box"></div>
      <div id="timer" class="timer-container">
        <div class="timer-label">ุงูููุช ุงููุชุจูู:</div>
        <div class="timer-display">
          <div class="timer-progress">
            <div id="timer-bar"></div>
          </div>
          <div class="timer-text"><span id="time">120</span> ุซุงููุฉ</div>
        </div>
      </div>
    </div>
    <div id="result"></div>
  </main>

  <footer>
    <p>ุนูู ุงูุทุงูุจุฉ: ุชุงููู ุงููุงููู | ุฅุดุฑุงู: ุงููุนููุฉ ูููุฑุฉ ุงูุฏูุณุฑู</p>
  </footer>

  <div class="mobile-nav quiz-mobile-nav">
    <a href="index.html" class="mobile-nav-button">
      <div class="mobile-nav-icon">๐</div>
      <div>ุงูุฑุฆูุณูุฉ</div>
    </a>
    <a href="quiz.html" class="mobile-nav-button">
      <div class="mobile-nav-icon">๐</div>
      <div>ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ</div>
    </a>
  </div>

  <script>
    const questions = [
      {
        q: "ูุง ุงุณู ูุงูุฏุฉ ุงููุจู ๏ทบุ",
        a: ["ุตููุฉ ุจูุช ุนุจุฏ ุงููุทูุจ", "ุฃู ุณููุฉ", "ุขููุฉ ุจูุช ููุจ", "ุฒููุจ ุจูุช ุฌุญุด"],
        correct: 2
      },
      {
        q: "ูู ูู ุฌุฏ ุงููุจู ๏ทบ ูู ุฌูุฉ ุฃุจููุ",
        a: ["ุนุจุฏ ููุงู", "ูุงุดู", "ุนุจุฏ ุงููุทูุจ", "ูุตู"],
        correct: 2
      },
      {
        q: "ูู ูู ูุงูุฏ ุงููุจู ูุญูุฏ ๏ทบุ",
        a: ["ุฃุจู ุทุงูุจ", "ุญูุฒุฉ ุจู ุนุจุฏ ุงููุทูุจ", "ุนุจุฏ ุงููู ุจู ุนุจุฏ ุงููุทูุจ", "ุงูุนุจุงุณ ุจู ุนุจุฏ ุงููุทูุจ"],
        correct: 2
      },
      {
        q: "ูู ูู ุฌุฏ ุงููุจู ๏ทบ ูู ุฌูุฉ ุฃููุ",
        a: ["ุนุจุฏ ุงููู ุจู ููุจ", "ุนุจุฏ ููุงู ุจู ุฒูุฑุฉ", "ููุจ ุจู ุนุจุฏ ููุงู", "ุฒูุฑุฉ ุจู ููุงุจ"],
        correct: 2
      },
      {
        q: "ูู ุฃู ุฌุฏ ููุชูู ุงููุณุจุ",
        a: ["ุนุจุฏ ููุงู ุจู ูุตู", "ูุงุดู ุจู ุนุจุฏ ููุงู", "ููุงุจ ุจู ูุฑุฉ", "ูุตู ุจู ููุงุจ"],
        correct: 2
      },
      {
        q: "ุฅูู ุฃู ูุจููุฉ ุชูุชูู ุขููุฉ ูุงูุฏุฉ ุงููุจู ๏ทบุ",
        a: ["ุจูู ูุงุดู", "ุจูู ุฃููุฉ", "ุจูู ุฒูุฑุฉ", "ุจูู ูุฎุฒูู"],
        correct: 2
      },
      {
        q: "ูู ูู ุงูุฌุฏ ุงูุฐู ุฌูุน ูุฑูุดูุง ูู ููุฉุ",
        a: ["ุนุจุฏ ุงููุทูุจ", "ูุงุดู", "ูุตู", "ุนุจุฏ ููุงู"],
        correct: 2
      }
    ];

    let current = 0;
    let score = 0;
    let timeLeft = 120;
    let timer;

    window.onload = () => {
      // ุชุฑุชูุจ ุงูุฃุณุฆูุฉ ุนุดูุงุฆููุง
      questions.sort(() => Math.random() - 0.5);
      showQuestion();
      startTimer();
    };

    function startTimer() {
      const totalTime = 120;
      timeLeft = totalTime;
      const timerBar = document.getElementById("timer-bar");
      const timerContainer = document.getElementById("timer");
      
      timer = setInterval(() => {
        timeLeft--;
        document.getElementById("time").textContent = timeLeft;
        
        // ุชุญุฏูุซ ุดุฑูุท ุงูุชูุฏู
        const percentage = (timeLeft / totalTime) * 100;
        timerBar.style.width = percentage + "%";
        
        // ุชุบููุฑ ููู ุงูุดุฑูุท ุนูุฏูุง ููุชุฑุจ ุงูููุช ูู ุงูููุงูุฉ
        if (timeLeft <= 30 && timeLeft > 10) {
          timerContainer.classList.add("timer-warning");
          timerContainer.classList.remove("timer-danger");
        } else if (timeLeft <= 10) {
          timerContainer.classList.add("timer-danger");
          timerContainer.classList.remove("timer-warning");
          // ุชุดุบูู ุตูุช ุชูุจูู ุนูุฏ ุงูุชุฑุงุจ ุงูุชูุงุก ุงูููุช
          if (timeLeft === 10 || timeLeft === 5) {
            playIncorrectSound();
          }
        }
        
        if (timeLeft <= 0) endQuiz();
      }, 1000);
    }

    function showQuestion() {
      const q = questions[current];
      document.getElementById("question").textContent = q.q;
      const answersDiv = document.getElementById("answers");
      answersDiv.innerHTML = "";
      
      // ุชุฑุชูุจ ุงูุฅุฌุงุจุงุช ุนุดูุงุฆููุง ูุน ุงูุงุญุชูุงุธ ุจุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ
      const correctAnswer = q.a[q.correct];
      const shuffledAnswers = [...q.a].sort(() => Math.random() - 0.5);
      const newCorrectIndex = shuffledAnswers.indexOf(correctAnswer);
      
      shuffledAnswers.forEach((ans, index) => {
        const btn = document.createElement("button");
        btn.textContent = ans;
        btn.onclick = () => checkAnswer(index, newCorrectIndex);
        answersDiv.appendChild(btn);
      });
    }

    function checkAnswer(selected, correctIndex) {
      const buttons = document.querySelectorAll("#answers button");
      
      if (selected === correctIndex) {
        // ุงูุฅุฌุงุจุฉ ุตุญูุญุฉ
        buttons[selected].classList.add("correct");
        playCorrectSound();
        score++;
      } else {
        // ุงูุฅุฌุงุจุฉ ุฎุงุทุฆุฉ
        buttons[selected].classList.add("incorrect");
        buttons[correctIndex].classList.add("correct");
        playIncorrectSound();
      }
      
      // ุชุนุทูู ุฌููุน ุงูุฃุฒุฑุงุฑ ุจุนุฏ ุงูุฅุฌุงุจุฉ
      buttons.forEach(btn => {
        btn.disabled = true;
      });
      
      // ุงูุงูุชูุงู ุฅูู ุงูุณุคุงู ุงูุชุงูู ุจุนุฏ ูุชุฑุฉ ูุตูุฑุฉ
      setTimeout(() => {
        current++;
        if (current < questions.length) {
          showQuestion();
        } else {
          endQuiz();
        }
      }, 1500);
    }

    function endQuiz() {
      clearInterval(timer);
      document.getElementById("quizBox").style.display = "none";
      const result = document.getElementById("result");
      result.style.display = "block";
      
      let message = "";
      if (score === questions.length) {
        message = "<h2>ููุชุงุฒ! ๐</h2><p>ููุฏ ุฃุฌุจุช ุนูู ุฌููุน ุงูุฃุณุฆูุฉ ุจุดูู ุตุญูุญ!</p>";
        message += '<p><a href="certificate.html" class="result-button certificate">ุนุฑุถ ุงูุดูุงุฏุฉ ๐</a></p>';
      } else if (score >= questions.length * 0.7) {
        message = `<h2>ุฃุญุณูุช! ๐</h2><p>ููุฏ ุฃุฌุจุช ุนูู ${score} ูู ${questions.length} ุฃุณุฆูุฉ ุจุดูู ุตุญูุญ.</p>`;
      } else if (score >= questions.length * 0.5) {
        message = `<h2>ุฌูุฏ! ๐</h2><p>ููุฏ ุฃุฌุจุช ุนูู ${score} ูู ${questions.length} ุฃุณุฆูุฉ ุจุดูู ุตุญูุญ.</p>`;
      } else {
        message = `<h2>ุญุงูู ูุฑุฉ ุฃุฎุฑู! ๐ช</h2><p>ููุฏ ุฃุฌุจุช ุนูู ${score} ูู ${questions.length} ุฃุณุฆูุฉ ุจุดูู ุตุญูุญ.</p>`;
      }
      
      message += '<div class="result-buttons">' +
        '<a href="quiz.html" class="result-button retry">๐ ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ</a>' +
        '<a href="index.html" class="result-button home">๐ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ</a>' +
        '</div>';
      
      result.innerHTML = message;
    }
  </script>
</body>
</html>
